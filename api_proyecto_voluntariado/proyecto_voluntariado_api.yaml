openapi: 3.0.3
info:
  title: API Plataforma de Voluntariado
  description: API Backend para la gestión de voluntarios, organizaciones y actividades solidarias.
  version: 2.0.0
servers:
  - url: http://localhost:8000/api
    description: Servidor Local Symfony

paths:
  # ==========================================
  # AUTENTICACIÓN Y REGISTRO
  # ==========================================

  /auth/register/voluntario:
    post:
      tags:
        - Autenticación
      summary: Registrar nuevo voluntario
      description: Crea un voluntario con perfil completo (habilidades, disponibilidad, etc.)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VoluntarioRegistro"
      responses:
        "201":
          description: Voluntario creado correctamente
        "400":
          description: Datos inválidos o contraseña demasiado corta
        "409":
          description: El DNI o Correo ya existen

  /auth/register/organizacion:
    post:
      tags:
        - Autenticación
      summary: Registrar nueva organización
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/OrganizacionRegistro"
      responses:
        "201":
          description: Organización creada correctamente
        "400":
          description: Datos inválidos o campos obligatorios faltantes
        "409":
          description: El CIF o Email ya existen

  /auth/login:
    post:
      tags:
        - Autenticación
      summary: Login unificado (proxy Firebase)
      description: Autentica al usuario contra Firebase y valida su estado en la base de datos local.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
      responses:
        "200":
          description: Login correcto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  token:
                    type: string
                    description: Firebase ID Token
                  refreshToken:
                    type: string
                  expiresIn:
                    type: string
                  localId:
                    type: string
                  email:
                    type: string
                  emailVerified:
                    type: boolean
                  rol:
                    type: string
                    enum: [admin, voluntario, organizacion]
        "400":
          description: Email y contraseña requeridos
        "401":
          description: Credenciales inválidas
        "403":
          description: Cuenta pendiente, rechazada o inactiva
        "404":
          description: Usuario no encontrado en base de datos local

  /auth/login/google:
    post:
      tags:
        - Autenticación
      summary: Login con Google (Firebase Token)
      description: Verifica un token de Google/Firebase y devuelve sesión si el usuario existe localmente.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [token]
              properties:
                token:
                  type: string
                  description: Firebase ID Token de Google Sign-In
      responses:
        "200":
          description: Login correcto
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  token:
                    type: string
                  email:
                    type: string
                  emailVerified:
                    type: boolean
                  rol:
                    type: string
        "400":
          description: Token requerido o email inválido
        "401":
          description: Token inválido o expirado
        "404":
          description: No existe cuenta vinculada a este correo

  /auth/forgot-password:
    post:
      tags:
        - Autenticación
      summary: Recuperar contraseña
      description: Envía un email con enlace de recuperación de contraseña vía Firebase.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email]
              properties:
                email:
                  type: string
                  format: email
      responses:
        "200":
          description: Si el correo existe, se ha enviado un enlace de recuperación
        "400":
          description: Email es obligatorio
        "500":
          description: Error al procesar la solicitud

  /auth/profile:
    get:
      tags:
        - Autenticación
      summary: Obtener perfil del usuario autenticado
      security:
        - bearerAuth: []
      description: Recupera el perfil del usuario autenticado vía Token.
      responses:
        "200":
          description: Perfil del usuario
          content:
            application/json:
              schema:
                type: object
                properties:
                  tipo:
                    type: string
                    enum: [admin, voluntario, organizacion]
                  datos:
                    type: object
        "401":
          description: No autorizado o token inválido
        "500":
          description: Tipo de usuario desconocido
    put:
      tags:
        - Autenticación
      summary: Actualizar perfil (Smart Update)
      security:
        - bearerAuth: []
      description: Actualiza los datos del perfil del usuario autenticado sin necesidad de ID.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              example:
                nombre: "Nuevo Nombre"
                zona: "Norte"
                habilidades: [1, 2]
      responses:
        "200":
          description: Perfil actualizado correctamente
        "401":
          description: No autorizado
        "500":
          description: Error del servidor

  # ==========================================
  # VOLUNTARIOS
  # ==========================================

  /voluntarios:
    get:
      tags:
        - Voluntarios
      summary: Listar todos los voluntarios
      description: Devuelve la lista completa de voluntarios registrados. Se puede filtrar por estado o buscar por email.
      parameters:
        - in: query
          name: estado
          schema:
            type: string
            enum: [PENDIENTE, ACEPTADO, RECHAZADO, LIBRE]
          required: false
          description: Filtrar voluntarios por su estado en la plataforma.
        - in: query
          name: email
          schema:
            type: string
          required: false
          description: Buscar voluntario por email exacto.
      responses:
        "200":
          description: Lista recuperada con éxito
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/VoluntarioDetalle"

  /voluntarios/{dni}:
    patch:
      tags:
        - Voluntarios
      summary: Actualizar estado del voluntario
      description: Cambia el estado del voluntario en la plataforma (PENDIENTE, ACEPTADO, RECHAZADO, LIBRE).
      parameters:
        - name: dni
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [estado]
              properties:
                estado:
                  type: string
                  enum: [PENDIENTE, ACEPTADO, RECHAZADO, LIBRE]
      responses:
        "200":
          description: Voluntario actualizado correctamente
          content:
            application/json:
              example:
                message: "Voluntario actualizado correctamente"
                estado: "ACEPTADO"
        "400":
          description: Estado inválido
        "404":
          description: Voluntario no encontrado
    put:
      tags:
        - Voluntarios
      summary: Actualizar perfil completo de voluntario
      description: Actualiza todos los datos editables de un voluntario por su DNI.
      parameters:
        - name: dni
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nombre:
                  type: string
                zona:
                  type: string
                experiencia:
                  type: string
                coche:
                  type: boolean
                habilidades:
                  type: array
                  items:
                    type: integer
                intereses:
                  type: array
                  items:
                    type: integer
      responses:
        "200":
          description: Voluntario actualizado correctamente
        "404":
          description: Voluntario no encontrado
        "500":
          description: Error al actualizar

  # ==========================================
  # ORGANIZACIONES
  # ==========================================

  /organizations:
    get:
      tags:
        - Organizaciones
      summary: Listar todas las organizaciones
      description: Devuelve la lista completa de organizaciones registradas, opcionalmente filtrada por estado.
      parameters:
        - in: query
          name: estado
          schema:
            type: string
            enum: [pendiente, aprobado, rechazado]
          required: false
          description: Filtrar organizaciones por su estado.
      responses:
        "200":
          description: Lista recuperada con éxito
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OrganizacionDetalle"
    post:
      tags:
        - Organizaciones
      summary: Registrar nueva organización (vía admin)
      description: Crea una nueva organización en la plataforma.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/OrganizacionRegistro"
      responses:
        "201":
          description: Organización creada correctamente
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizacionDetalle"
        "400":
          description: Datos inválidos
        "409":
          description: El CIF o Email ya existen

  /organizations/{cif}:
    put:
      tags:
        - Organizaciones
      summary: Actualizar datos de organización
      parameters:
        - name: cif
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nombre:
                  type: string
                email:
                  type: string
                sector:
                  type: string
                direccion:
                  type: string
                localidad:
                  type: string
                cp:
                  type: string
                descripcion:
                  type: string
                contacto:
                  type: string
      responses:
        "200":
          description: Organización actualizada correctamente
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizacionDetalle"
        "404":
          description: Organización no encontrada
    patch:
      tags:
        - Organizaciones
      summary: Actualizar estado u otros campos parciales de una organización
      description: Permite cambiar el estado (pendiente, aprobado, rechazado) u otros campos parciales.
      parameters:
        - name: cif
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                estado:
                  type: string
                  enum: [pendiente, aprobado, rechazado]
                fcmToken:
                  type: string
      responses:
        "200":
          description: Organización actualizada correctamente
        "400":
          description: Estado inválido
        "404":
          description: Organización no encontrada
    delete:
      tags:
        - Organizaciones
      summary: Eliminar organización
      parameters:
        - name: cif
          in: path
          required: true
          schema:
            type: string
      responses:
        "204":
          description: Organización eliminada (sin contenido)
        "404":
          description: Organización no encontrada

  /organizations/by-email:
    get:
      summary: Obtiene una organización por su email.
      tags:
        - Organizaciones
      parameters:
        - in: query
          name: email
          schema:
            type: string
            format: email
          required: true
          description: Email de la organización a buscar
          example: "organizacion@email.com"
      responses:
        "200":
          description: Datos de la organización.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizacionDetalle"
        "400":
          description: Email requerido.
        "404":
          description: Organización no encontrada.

  # ==========================================
  # ACTIVIDADES
  # ==========================================

  /actividades:
    get:
      tags:
        - Actividades
      summary: Listar todas las actividades
      description: Devuelve la lista de actividades disponibles, opcionalmente filtrada por estado de aprobación.
      parameters:
        - in: query
          name: estadoAprobacion
          schema:
            type: string
            enum: [PENDIENTE, ACEPTADA, RECHAZADA]
          required: false
          description: Filtrar actividades por su estado de aprobación.
      responses:
        "200":
          description: Lista recuperada con éxito
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ActividadDetalle"

  /actividades/crear:
    post:
      tags:
        - Actividades
      summary: Publicar una nueva actividad
      description: Una organización crea una actividad.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ActividadCreacion"
      responses:
        "201":
          description: Actividad creada exitosamente

  /actividades/{id}/editar:
    put:
      tags:
        - Actividades
      summary: Editar una actividad existente
      description: Actualiza los datos de una actividad existente.
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ActividadCreacion"
      responses:
        "200":
          description: Actividad actualizada correctamente
        "404":
          description: Actividad no encontrada

  /actividades/mis-actividades:
    get:
      tags:
        - Actividades
      summary: Obtener actividades del usuario autenticado
      security:
        - bearerAuth: []
      description: Devuelve las actividades en las que el voluntario autenticado está inscrito (con estado CONFIRMADO).
      responses:
        "200":
          description: Lista de actividades del usuario
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ActividadDetalle"
        "403":
          description: Solo voluntarios tienen acceso

  /actividades/organizacion/{cif}:
    get:
      summary: Obtiene las actividades de una organización (opcionalmente filtradas).
      tags:
        - Actividades
      parameters:
        - in: path
          name: cif
          schema:
            type: string
          required: true
          description: CIF de la organización
        - in: query
          name: estadoAprobacion
          schema:
            type: string
            enum: [PENDIENTE, ACEPTADA, RECHAZADA]
          required: false
          description: Filtra las actividades por el visto bueno del organizador.
        - in: query
          name: estado
          schema:
            type: string
          required: false
          description: Filtra por estado de ejecución de la actividad.
      responses:
        "200":
          description: Lista de actividades con información detallada.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ActividadDetalle"
        "404":
          description: Organización no encontrada.

  /actividades/{id}/inscribir:
    post:
      tags:
        - Actividades
      summary: Inscribirse en una actividad (Smart Subscribe)
      security:
        - bearerAuth: []
      description: El voluntario autenticado se apunta a la actividad indicada.
      parameters:
        - name: id
          in: path
          required: true
          description: ID de la actividad
          schema:
            type: integer
      responses:
        "201":
          description: Inscripción creada.
        "200":
          description: Ya estaba inscrito (estado reactivado).
        "403":
          description: Solo voluntarios pueden inscribirse.
        "404":
          description: Actividad no encontrada.
    delete:
      tags:
        - Actividades
      summary: Desinscribirse de una actividad (Smart Unsubscribe)
      security:
        - bearerAuth: []
      description: El voluntario autenticado se desapunta de la actividad indicada.
      parameters:
        - name: id
          in: path
          required: true
          description: ID de la actividad
          schema:
            type: integer
      responses:
        "200":
          description: Te has desapuntado correctamente
        "403":
          description: No autorizado
        "404":
          description: Actividad no encontrada o no estás inscrito

  /actividades/{id}:
    patch:
      tags:
        - Actividades
      summary: Actualizar estado de una actividad
      description: Cambia el estado de ejecución o de aprobación de una actividad.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID de la actividad
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [estado]
              properties:
                estado:
                  type: string
                  description: "Nuevo estado"
                tipo:
                  type: string
                  enum: [ejecucion, aprobacion]
                  description: "Tipo de estado a cambiar (opcional, por defecto infiere)"
      responses:
        "200":
          description: Estado actualizado.
          content:
            application/json:
              example:
                message: "Estado actualizado correctamente"
                campo_actualizado: "estado"
                valor_nuevo: "EN_CURSO"
        "400":
          description: Estado inválido o faltante.
        "404":
          description: Actividad no encontrada.
    delete:
      tags:
        - Actividades
      summary: Eliminar o cancelar actividad
      description: Elimina la actividad si no tiene inscripciones; si las tiene, la cancela.
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: Actividad eliminada o cancelada
          content:
            application/json:
              example:
                message: "Actividad eliminada permanentemente."
                action: "deleted"
        "404":
          description: Actividad no encontrada

  # ==========================================
  # INSCRIPCIONES
  # ==========================================

  /inscripciones:
    get:
      tags:
        - Inscripciones
      summary: Listar todas las inscripciones
      description: Devuelve una lista de inscripciones, opcionalmente filtrada por estado.
      parameters:
        - in: query
          name: estado
          schema:
            type: string
            enum: [PENDIENTE, CONFIRMADO, RECHAZADO, EN_CURSO, FINALIZADO, COMPLETADA]
          required: false
          description: Filtrar inscripciones por estado.
      responses:
        "200":
          description: Lista recuperada con éxito
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/InscripcionDetalle"
    post:
      tags:
        - Inscripciones
      summary: Crear una nueva inscripción
      description: Permite inscribir a un voluntario en una actividad especificando ambos IDs.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InscripcionNueva"
      responses:
        "201":
          description: Inscripción creada correctamente
        "400":
          description: Faltan datos o son inválidos
        "404":
          description: Voluntario o Actividad no encontrados
        "409":
          description: El voluntario ya está inscrito

  /inscripciones/{id}:
    patch:
      tags:
        - Inscripciones
      summary: Actualizar estado de inscripción
      description: Cambia el estado de una inscripción (ej. Confirmar, Rechazar).
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateEstadoRequest"
      responses:
        "200":
          description: Estado actualizado correctamente
          content:
            application/json:
              example:
                message: "Estado actualizado correctamente"
                nuevo_estado: "CONFIRMADO"
        "400":
          description: Estado inválido o falta campo
        "404":
          description: Inscripción no encontrada
    delete:
      tags:
        - Inscripciones
      summary: Cancelar inscripción
      description: Elimina una inscripción existente. Solo el voluntario propietario puede realizar esta acción.
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: Inscripción cancelada correctamente
        "403":
          description: No tienes permiso
        "404":
          description: Inscripción no encontrada

  /inscripciones/me:
    get:
      tags:
        - Inscripciones
      summary: Mis Inscripciones (Usa Token)
      security:
        - bearerAuth: []
      description: Recupera las inscripciones del voluntario autenticado. Permite filtrar por estado.
      parameters:
        - name: estado
          in: query
          required: false
          schema:
            type: string
            enum: [PENDIENTE, CONFIRMADO, RECHAZADO, EN_CURSO, FINALIZADO, COMPLETADA]
          description: Estado de la inscripción (opcional)
      responses:
        "200":
          description: Lista de inscripciones del usuario
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ActividadInscritaDetalle"
        "403":
          description: Solo voluntarios tienen acceso

  /inscripciones/voluntario/{dni}/inscripciones:
    get:
      tags:
        - Inscripciones
      summary: Listar inscripciones de un voluntario
      description: Recupera las inscripciones de un voluntario, opcionalmente filtradas por estado de inscripción.
      parameters:
        - name: dni
          in: path
          required: true
          description: DNI del voluntario
          schema:
            type: string
        - name: estado
          in: query
          required: false
          description: Estado de la inscripción para filtrar
          schema:
            type: string
            enum: [PENDIENTE, CONFIRMADO, RECHAZADO, EN_CURSO, FINALIZADO, COMPLETADA]
      responses:
        "200":
          description: Lista de inscripciones
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ActividadInscritaDetalle"
        "404":
          description: Voluntario no encontrado

  /inscripciones/organizacion/{cif}:
    get:
      tags:
        - Inscripciones
      summary: Listar inscripciones de actividades de una organización
      description: Devuelve todas las inscripciones para las actividades creadas por la organización especificada.
      parameters:
        - name: cif
          in: path
          required: true
          description: CIF de la organización
          schema:
            type: string
        - name: estado
          in: query
          required: false
          description: Filtrar por estado de la inscripción
          schema:
            type: string
            enum: [PENDIENTE, CONFIRMADO, RECHAZADO, EN_CURSO, FINALIZADO, COMPLETADA]
      responses:
        "200":
          description: Lista de inscripciones recuperada con éxito
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/InscripcionOrganizacionDetalle"
        "404":
          description: Organización no encontrada

  # ==========================================
  # NOTIFICACIONES
  # ==========================================

  /notificaciones:
    get:
      tags:
        - Notificaciones
      summary: Listar notificaciones del usuario autenticado
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Lista de notificaciones
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Notificacion"
        "401":
          description: No autenticado

  /notificaciones/{id}:
    patch:
      tags:
        - Notificaciones
      summary: Marcar notificación como leída
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                leido:
                  type: boolean
                  example: true
      responses:
        "200":
          description: Notificación actualizada correctamente
        "403":
          description: No tienes permiso para marcar esta notificación
        "404":
          description: Notificación no encontrada

  # ==========================================
  # CATEGORÍAS (DATA MAESTRA)
  # ==========================================

  /categories:
    get:
      tags:
        - Categorías
      summary: Listar categorías por tipo
      description: Endpoint unificado que devuelve ciclos, ODS, habilidades, intereses o necesidades según el parámetro type.
      parameters:
        - in: query
          name: type
          schema:
            type: string
            enum: [ciclos, ods, habilidades, intereses, necesidades]
          required: true
          description: Tipo de categoría a listar.
      responses:
        "200":
          description: Lista de la categoría solicitada
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
        "400":
          description: Tipo de categoría no válido o no especificado

  /categories/habilidades:
    post:
      tags:
        - Categorías
      summary: Crear nueva Habilidad
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [nombre]
              properties:
                nombre:
                  type: string
                  example: "Primeros Auxilios"
      responses:
        "201":
          description: Habilidad creada exitosamente
        "400":
          description: Nombre inválido o vacío

  /categories/habilidades/{id}:
    delete:
      tags:
        - Categorías
      summary: Eliminar Habilidad
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: Habilidad eliminada exitosamente
        "404":
          description: Habilidad no encontrada

  /categories/intereses:
    post:
      tags:
        - Categorías
      summary: Crear nuevo Interés
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [nombre]
              properties:
                nombre:
                  type: string
                  example: "Protección Animal"
      responses:
        "201":
          description: Interés creado exitosamente
        "400":
          description: Nombre inválido o vacío

  /categories/intereses/{id}:
    delete:
      tags:
        - Categorías
      summary: Eliminar Interés
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: Interés eliminado exitosamente
        "404":
          description: Interés no encontrado

  # ==========================================
  # ESTADÍSTICAS (DASHBOARD)
  # ==========================================

  /stats/general:
    get:
      summary: Obtener estadísticas generales del dashboard
      tags:
        - Estadísticas
      description: Devuelve los contadores de voluntarios, organizaciones, actividades y matches para el panel de control.
      responses:
        "200":
          description: Estadísticas recuperadas correctamente
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DashboardStats"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "Firebase ID Token"

  schemas:
    # --- MODELOS AUXILIARES ---
    ODS:
      type: object
      properties:
        id:
          type: integer
        nombre:
          type: string
        descripcion:
          type: string
        color:
          type: string
          example: "#E5243B"

    Habilidad:
      type: object
      properties:
        id:
          type: integer
        nombre:
          type: string

    Interes:
      type: object
      properties:
        id:
          type: integer
        nombre:
          type: string

    Necesidad:
      type: object
      properties:
        id:
          type: integer
        nombre:
          type: string

    CicloDetalle:
      type: object
      properties:
        nombre:
          type: string
          example: "Desarrollo de Aplicaciones Multiplataforma"
        curso:
          type: string
          example: "2º"

    # --- MODELO REGISTRO VOLUNTARIO ---
    VoluntarioRegistro:
      type: object
      required:
        [nombreCompleto, dni, correo, password, zona, ciclo, fechaNacimiento]
      properties:
        nombreCompleto:
          type: string
          example: "Juan Pérez García"
        dni:
          type: string
          example: "12345678Z"
        correo:
          type: string
          format: email
          example: "juan@gmail.com"
        password:
          type: string
          format: password
        zona:
          type: string
          example: "Pamplona"
        ciclo:
          type: string
          example: "DAW"
        fechaNacimiento:
          type: string
          format: date
          example: "1998-05-20"
        experiencia:
          type: string
          example: "Voluntariado previo en Cruz Roja"
        coche:
          type: string
          description: "Puede ser 'Si', 'No', 'true', etc."
          example: "Si"
        idiomas:
          type: array
          items:
            type: string
          example: ["Inglés", "Euskera"]
        habilidades:
          type: array
          items:
            type: string
          example: ["Primeros Auxilios", "Conducción"]
        intereses:
          type: array
          items:
            type: string
          example: ["Medio Ambiente", "Social"]
        disponibilidad:
          type: array
          items:
            type: string
          example: ["Lunes Mañana", "Fines de Semana"]

    # --- MODELO DETALLE VOLUNTARIO ---
    VoluntarioDetalle:
      type: object
      properties:
        dni:
          type: string
        nombre:
          type: string
        apellido1:
          type: string
        apellido2:
          type: string
        correo:
          type: string
        zona:
          type: string
        fechaNacimiento:
          type: string
          format: date
        experiencia:
          type: string
        coche:
          type: boolean
        habilidades:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
              nombre:
                type: string
        intereses:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
              nombre:
                type: string
        idiomas:
          type: array
          items:
            type: string
        estado_voluntario:
          type: string
          example: "PENDIENTE"
        disponibilidad:
          type: array
          items:
            type: string
        ciclo:
          type: string
        inscripciones:
          type: array
          items:
            type: object
            properties:
              id_inscripcion:
                type: integer
              actividad:
                type: string
              estado:
                type: string

    # --- MODELO REGISTRO ORGANIZACIÓN ---
    OrganizacionRegistro:
      type: object
      required:
        [cif, nombre, email, password, direccion, localidad, descripcion, cp, contacto]
      properties:
        cif:
          type: string
          example: "G99887766"
        nombre:
          type: string
          example: "Asociación Ayuda Mutua"
        email:
          type: string
          format: email
        password:
          type: string
          format: password
        sector:
          type: string
          example: "Salud"
        descripcion:
          type: string
          example: "ONG dedicada a..."
        direccion:
          type: string
          example: "Calle Mayor 12"
        localidad:
          type: string
          example: "Pamplona"
        cp:
          type: string
          example: "31001"
        contacto:
          type: string
          example: "600112233"

    OrganizacionDetalle:
      type: object
      properties:
        cif:
          type: string
        nombre:
          type: string
        estado:
          type: string
          example: "pendiente"
        email:
          type: string
          format: email
        sector:
          type: string
        direccion:
          type: string
        localidad:
          type: string
        cp:
          type: string
        descripcion:
          type: string
        contacto:
          type: string
        fcmToken:
          type: string
          nullable: true
        actividades:
          type: array
          items:
            $ref: "#/components/schemas/ActividadDetalle"

    # --- MODELOS DE ACTIVIDADES ---
    ActividadCreacion:
      type: object
      required: [cifOrganizacion, nombre]
      properties:
        cifOrganizacion:
          type: string
          description: "CIF de la organización dueña"
          example: "G99887766"
        nombre:
          type: string
          example: "Recogida de Alimentos"
        descripcion:
          type: string
        fechaInicio:
          type: string
          format: date
          example: "2025-12-01"
        fechaFin:
          type: string
          format: date
          example: "2025-12-31"
        maxParticipantes:
          type: integer
          example: 20
        ods:
          type: array
          items:
            type: string
          example: ["Hambre Cero", "Salud"]

    ActividadDetalle:
      type: object
      properties:
        codActividad:
          type: integer
        nombre:
          type: string
        descripcion:
          type: string
        estado:
          type: string
        estadoAprobacion:
          type: string
        direccion:
          type: string
        fechaInicio:
          type: string
          format: date-time
        fechaFin:
          type: string
          format: date-time
        maxParticipantes:
          type: integer
        cif_organizacion:
          type: string
        nombre_organizacion:
          type: string
        ods:
          type: array
          items:
            type: object
        habilidades:
          type: array
          items:
            type: object
        necesidades:
          type: array
          items:
            type: object

    # --- MODELO INSCRIPCIÓN ---
    InscripcionNueva:
      type: object
      required: [dniVoluntario, codActividad]
      properties:
        dniVoluntario:
          type: string
          example: "12345678Z"
        codActividad:
          type: integer
          example: 1

    InscripcionDetalle:
      type: object
      properties:
        id_inscripcion:
          type: integer
        dni_voluntario:
          type: string
        nombre_voluntario:
          type: string
        email_voluntario:
          type: string
        habilidades_voluntario:
          type: array
          items:
            type: object
        disponibilidad_voluntario:
          type: array
          items:
            type: string
        intereses_voluntario:
          type: array
          items:
            type: object
        codActividad:
          type: integer
        nombre_actividad:
          type: string
        email_organizacion:
          type: string
        habilidades_actividad:
          type: array
          items:
            type: object
        necesidades_actividad:
          type: array
          items:
            type: object
        maxParticipantes:
          type: integer
        estado:
          type: string
          example: "PENDIENTE"

    ActividadInscritaDetalle:
      type: object
      properties:
        id_inscripcion:
          type: integer
        estado_inscripcion:
          type: string
        codActividad:
          type: integer
        nombre:
          type: string
        direccion:
          type: string
        fechaInicio:
          type: string
          format: date-time
        fechaFin:
          type: string
          format: date-time
        organizacion:
          type: string
        estado_actividad:
          type: string
        ods:
          type: array
          items:
            type: object
        habilidades:
          type: array
          items:
            type: object
        necesidades:
          type: array
          items:
            type: object
        maxParticipantes:
          type: integer

    # --- MODELO ACTUALIZAR ESTADO ---
    UpdateEstadoRequest:
      type: object
      required: [estado]
      properties:
        estado:
          type: string
          description: "Nuevo estado (PENDIENTE, CONFIRMADO, RECHAZADO, EN_CURSO, FINALIZADO, COMPLETADA)"
          example: "CONFIRMADO"

    InscripcionOrganizacionDetalle:
      type: object
      properties:
        id_inscripcion:
          type: integer
        estado:
          type: string
          example: "PENDIENTE"
        voluntario:
          type: object
          properties:
            dni:
              type: string
        actividad:
          type: object
          properties:
            codActividad:
              type: integer

    # --- MODELO NOTIFICACIÓN ---
    Notificacion:
      type: object
      properties:
        id:
          type: integer
        titulo:
          type: string
        mensaje:
          type: string
        fecha:
          type: string
          format: date-time
        leido:
          type: boolean
        tipo:
          type: string

    # --- MODELO ESTADÍSTICAS ---
    DashboardStats:
      type: object
      properties:
        voluntarios:
          type: object
          properties:
            total:
              type: integer
            pendientes:
              type: integer
        organizaciones:
          type: object
          properties:
            total:
              type: integer
            pendientes:
              type: integer
        actividades:
          type: object
          properties:
            total:
              type: integer
            pendientes:
              type: integer
        matches:
          type: object
          properties:
            total:
              type: integer
        pendientes_global:
          type: integer
        desglose_inscripciones:
          type: object
          properties:
            completados:
              type: integer
            pendientes:
              type: integer
            aceptados:
              type: integer
